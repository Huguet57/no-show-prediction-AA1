appID <- as.numeric(dd$AppointmentID)
plot(appID, DateStamp)
plot(appID, SchedStamp)
mod <- glm(appID ~ SchedStamp)
Rsquared <- 1 - mod$deviance/mod$null.deviance
summary(mod)
Rsquared
dd$AppointmentID <- NULL
summary(dd)
# Export processed data to file
write.csv(dd, file = paste(DIR, 'data.csv', sep = "/"))
DIR <- 'W://AA1/'
setwd(DIR)
dd <- read.csv(paste(DIR, 'data.csv', sep="/"), encoding = 'UTF-8')
head(dd)
DIR <- 'W://AA1/'
setwd(DIR)
dd <- read.csv(paste(DIR, 'data.csv', sep="/"), encoding = 'UTF-8')
dd$PatientId <- factor(dd$PatientId)
head(dd)
dd$PatientId <- factor(dd$PatientId)
dd$X <- NULL
head(dd)
dd$PatientId <- factor(dd$PatientId)
dd$X <- NULL
colnames(dd)
head(dd)
barplot(No.show ~ Gender, data = dd)
barplot(No.show, Gender, data = dd)
barplot(dd$No.show, dd$Gender)
table(dd$No.show, dd$Gender)
table(No.show, Gender, data = dd)
table(dd$No.show, dd$Gender)
GenderNoShow[1,]
GenderNoShow <- table(dd$No.show, dd$Gender)
GenderNoShow <- table(dd$No.show, dd$Gender)
GenderNoShow[1,]
GenderNoShow <- table(dd$No.show, dd$Gender)
GenderNoShow[1,] <- GenderNoShow[1,]/sum(GenderNoShow[1,])
GenderNoShow[2,] <- GenderNoShow[2,]/sum(GenderNoShow[2,])
GenderNoShow
library(MASS)
GenderNoShow <- table(dd$No.show, dd$Gender)
GenderNoShow[1,] <- GenderNoShow[1,]/sum(GenderNoShow[1,])
GenderNoShow[2,] <- GenderNoShow[2,]/sum(GenderNoShow[2,])
chisq.test(GenderNoShow)
GenderNoShow <- table(dd$No.show, dd$Gender)
chisq.test(GenderNoShow)
GenderNoShow <- table(dd$No.show, dd$Gender)
chisq.test(GenderNoShow)
GenderNoShow <- table(dd$Gender, dd$No.show)
chisq.test(GenderNoShow)
is.factor(dd)
GenderNoShow <- table(dd$Gender, dd$No.show)
NeighNoShow <- table(dd$Neighbourhood, dd$No.show)
ScholarNoShow <- table(dd$Scholar, dd$No.show)
HipertensionNoShow <- table(dd$Scholar, dd$No.show)
DiabetesNoShow <- table(dd$Scholar, dd$No.show)
AlcoholismNoShow <- table(dd$Scholar, dd$No.show)
chisq.test(dd)
M <- table(dd$Hipertension, dd$Diabetes, dd$Alcoholism, dd$No.show)
chisq.test(M)
M <- table(dd$Hipertension, dd$Diabetes, dd$Alcoholism, dd$No.show)
chisq.test(M)
GenderNoShow <- table(dd$Gender, dd$No.show)
NeighNoShow <- table(dd$Neighbourhood, dd$No.show)
ScholarNoShow <- table(dd$Scholar, dd$No.show)
HipertensionNoShow <- table(dd$Hipertension, dd$No.show)
DiabetesNoShow <- table(dd$Diabetes, dd$No.show)
AlcoholismNoShow <- table(dd$Alcoholism, dd$No.show)
chisq.test(GenderNoShow)
chisq.test(NeighNoShow)
chisq.test(ScholarNoShow)
chisq.test(HipertensionNoShow)
chisq.test(DiabetesNoShow)
chisq.test(AlcoholismNoShow)
AlcoholismNoShow
ScholarNoShow
hist(Age)
hist(dd$Age)
hist(dd$Age)
plot(dd$Age, dd$No.show)
ddShow <- dd[which(dd$No.show == 'Yes'),]
ddNoShow <- dd[which(dd$No.show == 'No'),]
nrow(dd)
nrow(ddNoShow)
ddShow <- dd[which(dd$No.show == 'Yes'),]
ddNoShow <- dd[which(dd$No.show == 'No'),]
nrow(dd)
nrow(ddShow)
nrow(ddNoShow)
hist(ddShow$Age)
hist(ddNoShow$Age)
hist(ddShow$Age)
hist(ddNoShow$Age)
table(dd[which(dd$Age < 2),]$Age, dd[which(dd$Age < 2),]$No.show)
DIR <- 'W://AA1/'
setwd(DIR)
dd <- read.csv(paste(DIR, "hospital.csv", sep=""),
encoding = 'UTF-8')
if(!exists("foo", mode="function")) source("functions.R")
colnames(dd)
head(dd)
dd$PatientId <- factor(dd$PatientId, levels = unique(dd$PatientId))
dd$Gender <- factor(dd$Gender, levels = unique(dd$Gender))
dd$No.show <- factor(dd$No.show,
levels = unique(dd$No.show),
labels = c("NoShow", "Show"))
dd$Scholarship <- factor(dd$Scholarship,
levels = unique(dd$Scholarship),
labels = c("No", "Yes"))
dd$Hipertension <- factor(dd$Hipertension,
levels = unique(dd$Hipertension),
labels = c("Yes", "No"))
dd$Diabetes <- factor(dd$Diabetes,
levels = unique(dd$Diabetes),
labels = c("No", "Yes"))
dd$Alcoholism <- factor(dd$Alcoholism,
levels = unique(dd$Alcoholism),
labels = c("No", "Yes"))
dd$Handcap <- factor(dd$Handcap,
levels = unique(dd$Handcap),
labels = c("None", "Low", "Mid", "High", "VHigh"))
dd$SMS_received <- factor(dd$SMS_received,
levels = unique(dd$SMS_received),
labels = c("No", "Yes"))
neighbourhoods <- levels(dd$Neighbourhood)
short.neighbourhoods <- encodeNeighbourhood(neighbourhoods)
# Remove last element (which is blank)
short.neighbourhoods <- short.neighbourhoods[-length(short.neighbourhoods)]
length(unique(short.neighbourhoods))
length(neighbourhoods)
dd$Neighbourhood <- factor(dd$Neighbourhood, labels = short.neighbourhoods)
DIR <- 'W://AA1/'
setwd(DIR)
dd <- read.csv(paste(DIR, "hospital.csv", sep=""),
encoding = 'UTF-8')
if(!exists("foo", mode="function")) source("functions.R")
colnames(dd)
head(dd)
dd$PatientId <- factor(dd$PatientId, levels = unique(dd$PatientId))
dd$Gender <- factor(dd$Gender, levels = unique(dd$Gender))
dd$No.show <- factor(dd$No.show,
levels = unique(dd$No.show),
labels = c("NoShow", "Show"))
dd$Scholarship <- factor(dd$Scholarship,
levels = unique(dd$Scholarship),
labels = c("No", "Yes"))
dd$Hipertension <- factor(dd$Hipertension,
levels = unique(dd$Hipertension),
labels = c("Yes", "No"))
dd$Diabetes <- factor(dd$Diabetes,
levels = unique(dd$Diabetes),
labels = c("No", "Yes"))
dd$Alcoholism <- factor(dd$Alcoholism,
levels = unique(dd$Alcoholism),
labels = c("No", "Yes"))
dd$Handcap <- factor(dd$Handcap,
levels = unique(dd$Handcap),
labels = c("None", "Low", "Mid", "High", "VHigh"))
dd$SMS_received <- factor(dd$SMS_received,
levels = unique(dd$SMS_received),
labels = c("No", "Yes"))
neighbourhoods <- levels(dd$Neighbourhood)
short.neighbourhoods <- encodeNeighbourhood(neighbourhoods)
# Remove last element (which is blank)
short.neighbourhoods <- short.neighbourhoods[-length(short.neighbourhoods)]
length(unique(short.neighbourhoods))
length(neighbourhoods)
dd$Neighbourhood <- factor(dd$Neighbourhood, labels = short.neighbourhoods)
DYM <- getDYM(dd$ScheduledDay)
dd$SchedDay <- as.numeric(DYM$day)
dd$SchedMonth <- as.numeric(DYM$month)
dd$SchedYear <- as.numeric(DYM$year)
HM <- getHM(dd$ScheduledDay)
dd$SchedHour <- as.numeric(HM$hour)
dd$SchedMinute <- as.numeric(HM$minute)
DYM <- getDYM(dd$AppointmentDay)
dd$AppointDay <- as.numeric(DYM$day)
dd$AppointMonth <- as.numeric(DYM$month)
dd$AppointYear <- as.numeric(DYM$year)
dd$ScheduledDay <- NULL
dd$AppointmentDay <- NULL
dd$DateDiff <- dateDiff(dd)
range(unique(dd$Age))
dd <- dd[-which(dd$Age == -1),]
dd[which(dd$DateDiff < 0),]
dd <- dd[-which(dd$DateDiff < 0),]
barplot(table(dd$PatientId), names.arg = "Patient IDs")
# DateStamp = Days + Months*30 + Years*365
SchedStamp <- dd$SchedDay + dd$SchedMonth*30 + dd$SchedYear*365
DateStamp <- dd$AppointDay + dd$AppointMonth*30 + dd$AppointYear*365
appID <- as.numeric(dd$AppointmentID)
plot(appID, DateStamp)
plot(appID, SchedStamp)
mod <- glm(appID ~ SchedStamp)
Rsquared <- 1 - mod$deviance/mod$null.deviance
summary(mod)
Rsquared
dd$AppointmentID <- NULL
summary(dd)
# Export processed data to file
write.csv(dd, file = paste(DIR, 'data.csv', sep = "/"))
dd$PatientId <- factor(dd$PatientId, levels = unique(dd$PatientId))
dd$Gender <- factor(dd$Gender, levels = unique(dd$Gender))
dd$No.show <- factor(dd$No.show,
levels = unique(dd$No.show),
labels = c("Show", "NoShow"))
dd$Scholarship <- factor(dd$Scholarship,
levels = unique(dd$Scholarship),
labels = c("No", "Yes"))
dd$Hipertension <- factor(dd$Hipertension,
levels = unique(dd$Hipertension),
labels = c("Yes", "No"))
dd$Diabetes <- factor(dd$Diabetes,
levels = unique(dd$Diabetes),
labels = c("No", "Yes"))
dd$Alcoholism <- factor(dd$Alcoholism,
levels = unique(dd$Alcoholism),
labels = c("No", "Yes"))
dd$Handcap <- factor(dd$Handcap,
levels = unique(dd$Handcap),
labels = c("None", "Low", "Mid", "High", "VHigh"))
dd$SMS_received <- factor(dd$SMS_received,
levels = unique(dd$SMS_received),
labels = c("No", "Yes"))
DIR <- 'W://AA1/'
setwd(DIR)
dd <- read.csv(paste(DIR, "hospital.csv", sep=""),
encoding = 'UTF-8')
if(!exists("foo", mode="function")) source("functions.R")
colnames(dd)
head(dd)
dd$PatientId <- factor(dd$PatientId, levels = unique(dd$PatientId))
dd$Gender <- factor(dd$Gender, levels = unique(dd$Gender))
dd$No.show <- factor(dd$No.show,
levels = unique(dd$No.show),
labels = c("Show", "NoShow"))
dd$Scholarship <- factor(dd$Scholarship,
levels = unique(dd$Scholarship),
labels = c("No", "Yes"))
dd$Hipertension <- factor(dd$Hipertension,
levels = unique(dd$Hipertension),
labels = c("Yes", "No"))
dd$Diabetes <- factor(dd$Diabetes,
levels = unique(dd$Diabetes),
labels = c("No", "Yes"))
dd$Alcoholism <- factor(dd$Alcoholism,
levels = unique(dd$Alcoholism),
labels = c("No", "Yes"))
dd$Handcap <- factor(dd$Handcap,
levels = unique(dd$Handcap),
labels = c("None", "Low", "Mid", "High", "VHigh"))
dd$SMS_received <- factor(dd$SMS_received,
levels = unique(dd$SMS_received),
labels = c("No", "Yes"))
neighbourhoods <- levels(dd$Neighbourhood)
short.neighbourhoods <- encodeNeighbourhood(neighbourhoods)
# Remove last element (which is blank)
short.neighbourhoods <- short.neighbourhoods[-length(short.neighbourhoods)]
length(unique(short.neighbourhoods))
length(neighbourhoods)
dd$Neighbourhood <- factor(dd$Neighbourhood, labels = short.neighbourhoods)
DYM <- getDYM(dd$ScheduledDay)
dd$SchedDay <- as.numeric(DYM$day)
dd$SchedMonth <- as.numeric(DYM$month)
dd$SchedYear <- as.numeric(DYM$year)
HM <- getHM(dd$ScheduledDay)
dd$SchedHour <- as.numeric(HM$hour)
dd$SchedMinute <- as.numeric(HM$minute)
DYM <- getDYM(dd$AppointmentDay)
dd$AppointDay <- as.numeric(DYM$day)
dd$AppointMonth <- as.numeric(DYM$month)
dd$AppointYear <- as.numeric(DYM$year)
dd$ScheduledDay <- NULL
dd$AppointmentDay <- NULL
dd$DateDiff <- dateDiff(dd)
range(unique(dd$Age))
dd <- dd[-which(dd$Age == -1),]
dd[which(dd$DateDiff < 0),]
dd <- dd[-which(dd$DateDiff < 0),]
barplot(table(dd$PatientId), names.arg = "Patient IDs")
# DateStamp = Days + Months*30 + Years*365
SchedStamp <- dd$SchedDay + dd$SchedMonth*30 + dd$SchedYear*365
DateStamp <- dd$AppointDay + dd$AppointMonth*30 + dd$AppointYear*365
appID <- as.numeric(dd$AppointmentID)
plot(appID, DateStamp)
plot(appID, SchedStamp)
mod <- glm(appID ~ SchedStamp)
Rsquared <- 1 - mod$deviance/mod$null.deviance
summary(mod)
Rsquared
dd$AppointmentID <- NULL
summary(dd)
# Export processed data to file
write.csv(dd, file = paste(DIR, 'data.csv', sep = "/"))
DIR <- 'W://AA1/'
setwd(DIR)
library(MASS)
dd <- read.csv(paste(DIR, 'data.csv', sep="/"), encoding = 'UTF-8')
dd$PatientId <- factor(dd$PatientId)
dd$X <- NULL
colnames(dd)
head(dd)
DIR <- 'W://AA1/'
setwd(DIR)
library(MASS)
dd <- read.csv(paste(DIR, 'data.csv', sep="/"), encoding = 'UTF-8')
dd$PatientId <- factor(dd$PatientId)
dd$X <- NULL
colnames(dd)
head(dd)
ddNoShow <- dd[which(dd$No.show == 'Yes'),]
ddShow <- dd[which(dd$No.show == 'No'),]
ddNoShow <- dd[which(dd$No.show == 'NoShow'),]
ddShow <- dd[which(dd$No.show == 'Show'),]
hist(ddShow$Age)
hist(ddNoShow$Age)
table(dd[which(dd$Age < 2),]$Age, dd[which(dd$Age < 2),]$No.show)
hist(ddShow$Age)
hist(ddNoShow$Age)
mean(dd$Age)
apply(dd$Age)
apply(dd$Age, mean)
center(dd$Age)
sapply(dd$Age)
sapply(dd$Age, mean)
library(MASS)
DIR <- 'W://AA1/'
setwd(DIR)
dd <- read.csv(paste(DIR, 'data.csv', sep="/"), encoding = 'UTF-8')
dd$PatientId <- factor(dd$PatientId)
dd$X <- NULL
colnames(dd)
head(dd)
ddNoShow <- dd[which(dd$No.show == 'NoShow'),]
ddShow <- dd[which(dd$No.show == 'Show'),]
logreg <- glm(No.Show ~ Age, family = binomial)
logreg <- glm(No.Show ~ Age,
family = binomial,
data = dd)
logreg <- glm(No.show ~ Age,
family = binomial,
data = dd)
logreg <- glm(No.show ~ Age,
family = binomial,
data = dd)
summary(logreg)
predict(logreg)
pred <- predict(logreg, type = "response")
head(pred)
res <- residuals(mod, type = "deviance")
head(res)
head(pred)
head(res)
head(pred)
logreg <- glm(No.show ~ Age + Handcap,
family = binomial,
data = dd)
summary(logreg)
logreg <- glm(No.show ~ Age,
family = binomial,
data = dd)
summary(logreg)
pred <- predict(logreg, type = "response")
head(pred)
(pred > 0.5)
results <- (predFT == dd$No.show)
predFT <- (pred >= 0.5)
results <- (predFT == dd$No.show)
summary(results)
predFT <- (pred >= 0.5)
head(predFT)
tail(predFT)
summary(predFT)
head(pred)
plot(pred)
pred <- predict(logreg,
dd$No.show,
type = "response")
logreg <- glm(No.show ~ Age,
family = binomial,
data = dd)
summary(logreg)
pred <- predict(logreg,
dd$No.show,
type = "response")
logreg <- glm(No.show ~ Age,
family = binomial,
data = dd)
summary(logreg)
pred <- predict(logreg,
dd,
type = "response")
plot(pred)
summary(pred)
summary(pred)
plot(dd$No.show, pred)
plot(pred, dd$No.show)
summary(dd$No.Show)
summary(dd$No.show)
logreg <- glm(No.show ~ Age,
family = binomial,
data = dd)
summary(logreg)
levels(dd$No.show) <- c(0,1)
levels(dd$No.show) <- c(0,1)
summary(dd$No.show)
summary(dd$No.show)
levels(dd$No.show) <- c(1,0)
levels(dd$No.show) <- c(1,0)
summary(dd$No.show)
logreg <- glm(No.show ~ Age,
family = binomial,
data = dd)
summary(logreg)
pred <- predict(logreg,
dd,
type = "response")
plot(pred, dd$No.show)
summary(pred)
summary(logit(pred))
summary(pred)
levels(dd$No.show) <- c(1,0)
summary(dd$No.show)
logreg <- glm(No.show ~ Age,
family = binomial,
data = dd)
summary(logreg)
pred <- predict(logreg,
dd,
type = "response")
summary(pred)
table(dd$No.show, pred > 0.7991)
colnames(dd)
logreg <- glm(No.show ~ Age + DateDiff,
family = binomial,
data = dd)
summary(logreg)
pred <- predict(logreg,
dd,
type = "response")
summary(pred)
colnames(dd)
logreg <- glm(No.show ~ Age + DateDiff + Neighbourhood,
family = binomial,
data = dd)
summary(logreg)
pred <- predict(logreg,
dd,
type = "response")
summary(pred)
training <- dd[1:100000,]
test <- dd[100001:nrow(dd),]
colnames(dd)
levels(dd$No.show) <- c(1,0)
summary(dd$No.show)
training <- dd[1:100000,]
test <- dd[100001:nrow(dd),]
logreg <- glm(No.show ~ Age + DateDiff + Neighbourhood,
family = binomial,
data = training)
summary(logreg)
colnames(dd)
levels(dd$No.show) <- c(1,0)
summary(dd$No.show)
training <- dd[1:100000,]
test <- dd[100001:nrow(dd),]
logreg <- glm(No.show ~ Age + DateDiff,
family = binomial,
data = training)
pred <- predict(logreg,
test,
type = "response")
summary(pred)
table(test, pred > 0.5)
table(test$No.show, pred > 0.5)
colnames(dd)
levels(dd$No.show) <- c(1,0)
summary(dd$No.show)
training <- dd[1:80000,]
test <- dd[80001:nrow(dd),]
logreg <- glm(No.show ~ Age + DateDiff,
family = binomial,
data = training)
pred <- predict(logreg,
test,
type = "response")
table(test$No.show, pred > 0.5)
library(MASS)
DIR <- 'W://AA1/'
setwd(DIR)
dd <- read.csv(paste(DIR, 'data.csv', sep="/"), encoding = 'UTF-8')
dd$PatientId <- factor(dd$PatientId)
dd$X <- NULL
colnames(dd)
head(dd)
ddNoShow <- dd[which(dd$No.show == 'NoShow'),]
ddShow <- dd[which(dd$No.show == 'Show'),]
hist(ddShow$Age)
hist(ddNoShow$Age)
colnames(dd)
summary(dd$No.show)
training <- dd[1:80000,]
test <- dd[80001:nrow(dd),]
logreg <- glm(No.show ~ Age + DateDiff,
family = binomial,
data = training)
pred <- predict(logreg,
test,
type = "response")
table(test$No.show, pred > 0.5)
